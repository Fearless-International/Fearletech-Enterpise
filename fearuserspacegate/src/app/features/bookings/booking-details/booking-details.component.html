<div class="booking-details-container">
  <div class="back-button-container">
    <button pButton icon="pi pi-arrow-left" label="Back to Bookings" (click)="goBack()" class="p-button-text"></button>
  </div>
  
  <p-card *ngIf="!loading && booking">
    <ng-template pTemplate="header">
      <div class="booking-header">
        <div class="booking-title">
          <h2>Booking #{{ booking.id }}</h2>
          <span class="status-badge" [ngClass]="'status-' + booking.status">
            {{ booking.status | titlecase }}
          </span>
        </div>
        <div class="booking-actions">
          <button pButton icon="pi pi-pencil" label="Edit" (click)="editBooking()" class="p-button-outlined"></button>
          <button pButton icon="pi pi-trash" label="Delete" (click)="deleteBooking()" class="p-button-outlined p-button-danger"></button>
        </div>
      </div>
    </ng-template>
    
    <div class="booking-content p-grid">
      <div class="p-col-12 p-md-6">
        <div class="info-section">
          <h3>Booking Information</h3>
          <div class="info-item">
            <label>Service:</label>
            <span>{{ booking.service }}</span>
          </div>
          <div class="info-item">
            <label>Date:</label>
            <span>{{ booking.date | date:'fullDate' }}</span>
          </div>
          <div class="info-item">
            <label>Time:</label>
            <span>{{ booking.time | date:'shortTime' }}</span>
          </div>
          <div class="info-item">
            <label>Status:</label>
            <div class="status-dropdown">
              <span 
                *ngFor="let status of statusOptions" 
                [class.active]="booking.status === status.value"
                class="status-option"
                [style.borderColor]="status.color"
                (click)="updateStatus(status.value)"
              >
                <i [class]="status.icon"></i>
                {{ status.label }}
              </span>
            </div>
          </div>
          <div class="info-item" *ngIf="booking.notes">
            <label>Notes:</label>
            <div class="notes-content">
              {{ booking.notes }}
            </div>
          </div>
        </div>
      </div>
      
      <div class="p-col-12 p-md-6">
        <div class="info-section">
          <h3>Client Information</h3>
          <div class="client-card">
            <div class="client-icon">
              <i class="pi pi-user"></i>
            </div>
            <div class="client-details">
              <h4>{{ booking.user.name }}</h4>
              <div class="client-contact">
                <div class="contact-item">
                  <i class="pi pi-envelope"></i>
                  <span>{{ booking.user.email }}</span>
                </div>
                <div class="contact-item">
                  <i class="pi pi-phone"></i>
                  <span>{{ booking.user.phone }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="info-section">
          <h3>Booking Timeline</h3>
          <div class="timeline">
            <div class="timeline-item">
              <div class="timeline-indicator created"></div>
              <div class="timeline-content">
                <h5>Booking Created</h5>
                <p>{{ booking.createdAt | date:'medium' }}</p>
              </div>
            </div>
            <div class="timeline-item" *ngIf="booking.status !== 'pending'">
              <div class="timeline-indicator" [ngClass]="booking.status"></div>
              <div class="timeline-content">
                <h5>Booking {{ booking.status | titlecase }}</h5>
                <p>{{ booking.updatedAt | date:'medium' }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </p-card>
  
  <div class="loading-container" *ngIf="loading">
    <p-progressSpinner styleClass="w-4rem h-4rem" strokeWidth="8" fill="#EEEEEE" animationDuration=".5s"></p-progressSpinner>
    <p>Loading booking details...</p>
  </div>
  
  <div class="error-container" *ngIf="!loading && !booking">
    <p-card>
      <div class="error-content">
        <i class="pi pi-exclamation-circle"></i>
        <h3>Booking Not Found</h3>
        <p>The booking you are looking for does not exist or has been removed.</p>
        <button pButton label="Go Back to Bookings" (click)="goBack()"></button>
      </div>
    </p-card>
  </div>
</div>

<p-toast></p-toast>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>